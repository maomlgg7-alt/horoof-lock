<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Horoof Lock</title>

<!-- PWA -->
<link rel="manifest" href="data:application/json,{
  &quot;name&quot;:&quot;Horoof Lock&quot;,
  &quot;short_name&quot;:&quot;Horoof&quot;,
  &quot;start_url&quot;:&quot;.&quot;,
  &quot;display&quot;:&quot;standalone&quot;,
  &quot;background_color&quot;:&quot;#000814&quot;,
  &quot;theme_color&quot;:&quot;#00e5ff&quot;
}">
<meta name="theme-color" content="#00e5ff">

<style>
*{box-sizing:border-box;margin:0;padding:0}
:root{
  --bg:#000814;
  --card:#001d3d;
  --accent:#00e5ff;
  --text:#e0f7ff;
  --glass:rgba(255,255,255,0.04);
}
body{
  font-family:system-ui,Arial;
  background:radial-gradient(circle at top,#001d3d,#000814);
  color:var(--text);
  min-height:100vh;
  padding:16px;
}
header{
  display:flex;
  justify-content:space-between;
  align-items:center;
  margin-bottom:12px;
}
h1{color:var(--accent)}
select,button,input,textarea{
  background:var(--card);
  border:1px solid rgba(0,229,255,.2);
  color:var(--text);
  padding:8px;
  border-radius:8px;
}
button{cursor:pointer}
main{
  max-width:900px;
  margin:auto;
  display:grid;
  gap:12px;
}
.card{
  background:var(--glass);
  border-radius:16px;
  padding:14px;
  box-shadow:0 10px 30px rgba(0,0,0,.5);
}
textarea{
  width:100%;
  min-height:140px;
  resize:vertical;
}
.row{
  display:flex;
  gap:8px;
  flex-wrap:wrap;
}
.badge{
  background:rgba(0,229,255,.1);
  padding:4px 10px;
  border-radius:999px;
  font-size:.8rem;
}
footer{
  text-align:center;
  opacity:.6;
  margin-top:16px;
  font-size:.8rem;
}
@media(min-width:760px){
  main{grid-template-columns:1fr 1fr}
}
</style>
</head>

<body>
<header>
  <h1>ğŸ” Horoof Lock</h1>
  <div class="row">
    <select id="uiLang">
      <option value="ar">Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</option>
      <option value="en">English</option>
      <option value="pt">PortuguÃªs</option>
    </select>
    <select id="cipher">
      <option value="arabic">Arabic</option>
      <option value="rot13">ROT13</option>
      <option value="shift1">Shift +1</option>
      <option value="custom">Custom</option>
    </select>
  </div>
</header>

<main>
<!-- INPUT -->
<section class="card">
  <input id="title" placeholder="Ø¹Ù†ÙˆØ§Ù† (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)">
  <textarea id="input" placeholder="Ø§Ù„Ù†Øµ Ù‡Ù†Ø§..."></textarea>

  <div class="row" style="margin-top:8px">
    <button onclick="encrypt()">ğŸ”’ Ø´ÙØ±</button>
    <button onclick="decrypt()">ğŸ”“ ÙÙƒ</button>
    <button onclick="swap()">â†”ï¸ ØªØ¨Ø¯ÙŠÙ„</button>
    <button onclick="clearAll()">ğŸ§¹ Ù…Ø³Ø­</button>
  </div>

  <div class="row" style="margin-top:8px;justify-content:space-between">
    <span class="badge" id="count">0 Ø­Ø±Ù</span>
    <span class="badge" id="stamp">â€”</span>
  </div>
</section>

<!-- OUTPUT -->
<section class="card">
  <textarea id="output" placeholder="Ø§Ù„Ù†ØªÙŠØ¬Ø©..."></textarea>

  <div class="row" style="margin-top:8px">
    <button onclick="copyText()">ğŸ“‹ Ù†Ø³Ø®</button>
    <button onclick="download()">â¬‡ï¸ ØªØ­Ù…ÙŠÙ„</button>
    <button onclick="share()">ğŸ“¤ Ù…Ø´Ø§Ø±ÙƒØ©</button>
  </div>

  <textarea id="customMap" placeholder="Ø®Ø±ÙŠØ·Ø© Ù…Ø®ØµØµØ©
Ø§=Ùˆ
Ø¨=Ø¯
Øª=Ø·" style="margin-top:10px;min-height:80px"></textarea>
</section>
</main>

<footer>Â© 2025 â€” Ù…ØµÙ†ÙˆØ¹ Ø®ØµÙŠØµÙ‹Ø§ Ù„Ù…Ø¤Ù…Ù„ â¤ï¸</footer>

<script>
// ===== Direction =====
const uiLang = document.getElementById('uiLang');
function updateDir(){
  document.body.dir = uiLang.value === 'ar' ? 'rtl' : 'ltr';
}
uiLang.onchange = updateDir;
updateDir();

// ===== CIPHERS =====
const arabic = {"Ø§":"Ùˆ","Ø¨":"Ø¯","Øª":"Ø·","Ø«":"Ø°","Ø¬":"Ø²","Ø­":"Ø®","Ø®":"Ø­","Ø¯":"Ø¶","Ø°":"Ø«","Ø±":"Ù„","Ø²":"Ø¬","Ø³":"Ø´","Ø´":"Ø³","Øµ":"Ø¹","Ø¶":"ÙŠ","Ø·":"Ù","Ø¸":"Ù‚","Ø¹":"Øµ","Ù":"Ø·","Ù‚":"Ø¸","Ùƒ":"0","Ù„":"1","Ù…":"2","Ù†":"3","Ù‡":"4","Ùˆ":"5","ÙŠ":"6"};
const rot13 = {};
"abcdefghijklmnopqrstuvwxyz".split("").forEach((c,i)=>{
  rot13[c]="abcdefghijklmnopqrstuvwxyz"[(i+13)%26];
  rot13[c.toUpperCase()]=rot13[c].toUpperCase();
});
const shift1 = {};
"abcdefghijklmnopqrstuvwxyz".split("").forEach((c,i)=>{
  shift1[c]="abcdefghijklmnopqrstuvwxyz"[(i+1)%26];
  shift1[c.toUpperCase()]=shift1[c].toUpperCase();
});

function getMap(){
  const type=document.getElementById('cipher').value;
  if(type==="arabic") return arabic;
  if(type==="rot13") return rot13;
  if(type==="shift1") return shift1;
  const map={};
  document.getElementById('customMap').value.split(/,|\n/)
    .forEach(l=>{
      const[a,b]=l.split('=');
      if(a&&b) map[a.trim()]=b.trim();
    });
  return map;
}

function apply(text,map,rev){
  const inv={};
  if(rev) for(const k in map) if(!(map[k] in inv)) inv[map[k]]=k;
  return [...text].map(ch=>rev?(inv[ch]??ch):(map[ch]??ch)).join('');
}

// ===== ACTIONS =====
const input=document.getElementById('input');
const output=document.getElementById('output');
input.oninput=()=>document.getElementById('count').textContent=input.value.length+" Ø­Ø±Ù";

function stamp(){
  document.getElementById('stamp').textContent=new Date().toLocaleString();
}

function encrypt(){
  output.value=apply(input.value,getMap(),false);
  stamp();
}
function decrypt(){
  output.value=apply(input.value,getMap(),true);
  stamp();
}
function swap(){
  [input.value,output.value]=[output.value,input.value];
}
function clearAll(){
  input.value=output.value='';
}
function copyText(){
  navigator.clipboard.writeText(output.value||input.value);
  alert("ØªÙ… Ø§Ù„Ù†Ø³Ø® âœ…");
}
function download(){
  const a=document.createElement('a');
  a.href=URL.createObjectURL(new Blob([output.value],{type:'text/plain'}));
  a.download=(document.getElementById('title').value||"horoof")+".txt";
  a.click();
}
async function share(){
  if(navigator.share){
    await navigator.share({text:output.value});
  }else alert("Ø§Ù„Ù…ØªØµÙØ­ Ù„Ø§ ÙŠØ¯Ø¹Ù… Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ©");
}

// ===== Service Worker Inline =====
if('serviceWorker'in navigator){
  const swCode=`self.addEventListener('fetch',e=>{e.respondWith(fetch(e.request).catch(()=>new Response('Offline')))})`;
  const blob=new Blob([swCode],{type:'text/javascript'});
  navigator.serviceWorker.register(URL.createObjectURL(blob));
}
</script>
</body>
</html>